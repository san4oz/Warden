<div  ng-controller="transactionController">
    <ul class="tab">
        <li class="tab-link" ng-class="{active: tabs.isSet(1)}">
            <a href="" ng-click="tabs.setTab(1)">Оброблені</a>
        </li>
        <li class="tab-link" ng-class="{active: tabs.isSet(2)}">
            <a href="" ng-click="tabs.setTab(2)">Обробка</a>
        </li>
        <li class="tab-link" ng-class="{active: tabs.isSet(3)}">
            <a href="" ng-click="tabs.setTab(3)">Імпорт</a>
        </li>       
        <li class="tab-link">
            <span>Загальна кількість транзакцій: {{transactionCount}}</span>
        </li>
    </ul>

    <div ng-show="tabs.isSet(1)" class="pure-g searched-data">
        <div class="pure-u-1-1">
            <select ng-change="getCategoryTransactions(selectedCategory)" ng-model="selectedCategory" ng-options="category as category.Title for category in categories"></select>
            <table class="pure-table">
                <thead>
                    <tr>
                        <th>Номер</th>
                        <th>Ціна</th>
                        <th>Призначення</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="transaction in transactions">
                        <td>{{transaction.Id}}</td>
                        <td>{{transaction.Price}}</td>
                        <td>{{transaction.Keywords}}</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div ng-show="tabs.isSet(2)" class="pure-g searched-data">
        <div class="pure-u-1-1">
            <input type="search" ng-keyup="search(searchQuery)" ng-model="searchQuery" style="width: 100%;" />
            <table class="pure-table pure-table-horizontal">
                <thead>
                    <tr>
                        <th>Вартість</th>
                        <th>Призначення</th>
                        <th></th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="transaction in transactions">
                        <td>{{transaction.Price | currency}}</td>
                        <td>{{transaction.Keywords}}</td>
                        <td>
                            <select ng-model="selectedCategory" ng-options="category as category.Title for category in categories"></select>
                        </td>
                        <td><button ng-disabled="!selectedCategory" ng-click="attachToCategory(transaction, selectedCategory)">Додати</button></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div ng-show="tabs.isSet(3)" class="pure-g searched-data">
        <div class="pure-u-1-1">
            <table class="pure-table">
                <thead>
                    <tr>
                        <th>Платник</th>
                        <th>Статус</th>
                        <th><button ng-click="startImportTaskAll()" class="pure-button pure-button-danger">Запустити всі</button></th>
                        <th>Налаштування</th>
                        <th>Лог</th>
                    </tr>
                </thead>
                <tbody>
                    <tr ng-repeat="payer in payers">
                        <td>{{payer.Name}}</td>
                        <td>
                            <span ng-show="IsTaskInProgress(payer)"><i class="fa fa-spinner fa-spin" aria-hidden="true"></i></span>
                            <span ng-show="IsTaskFinished(payer)"><i class="fa fa-check" aria-hidden="true"></i></span>
                            <span ng-show="IsTaskFailed(payer)"><i class="fa fa-close" aria-hidden="true"></i></span>
                            <span ng-show="IsTaskNotStarted(payer)"><i class="fa fa-circle-o" aria-hidden="true"></i></span>
                        </td>
                        <td>
                            <button ng-disabled="IsTaskRunning(payer)" ng-click="startImportTask(payer)" class="pure-button">Запустити</button>
                        </td>
                        <td><a ng-href="/admin/transaction-import/settings/{{payer.PayerId}}"><i class="fa fa-cog" aria-hidden="true"></i></a></td>
                        <td>Лог</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
